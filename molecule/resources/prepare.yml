---
- name: Add epel
  hosts: centos8
  tasks:
    - name: install rpm key
      rpm_key:
        state: present
        key: https://dl.fedoraproject.org/pub/epel/RPM-GPG-KEY-EPEL-{{ ansible_distribution_major_version }}
    - name: Enable EPEL repository
      dnf:
        name: 'https://dl.fedoraproject.org/pub/epel/epel-release-latest-{{ ansible_distribution_major_version }}.noarch.rpm'
        state: present
        update_cache: true
      register: status
      until: status is succeeded
      become: true
